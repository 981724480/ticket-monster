<!DOCTYPE html>
<html>
<head>
    <title>Ticket Monster - mobile version</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=0;"/>

    <link type="text/css" rel="stylesheet" href="resources/css/m.screen.css"/>
    <link rel="stylesheet" href="//code.jquery.com/mobile/1.0.1/jquery.mobile-1.0.1.min.css"/>
    <script type="text/javascript" src="resources/js/jquery-1.7.1.min.js"></script>
    <script type="text/javascript" src="resources/js/jquery.mobile.router.js"></script>
    <script type="text/javascript" src="resources/js/jquery.mobile-1.0.1.min.js"></script>

    <script type="text/javascript" src="resources/js/underscore.js"></script>
    <script type="text/javascript" src="resources/js/backbone.js"></script>
    <script type="text/javascript" src="resources/js/tm-utils.js"></script>


</head>

<body>

<script id="template-view" type="text/template">
     <a href="<%= element.url %>"><%=element.name%></a>
</script>

<div id="index" data-role="page">
    <div data-role="header">Ticket Monster1</div>

    <div data-role="content">

        <ul data-role="listview">
            <li>
                <a href="#two">Concert</a>
            </li>
            <li>
                Sporting
            </li>
        </ul>
        <a href="#two">Page two</a>
    </div>
</div>

<div id="two" data-role="page">
    <div data-role="header">Events</div>

    <div data-role="content">
        Page one
        <ul data-role="listview">
            <li>
                <a>Shane's stuff</a>
            </li>
            <li>
                Some other event
            </li>
        </ul>
        <a href="#index">Back</a>
        <div id="footer"/>
    </div>
</div>


<script type="text/javascript">
    window.TicketMonster = new Object();

    var router = new $.mobile.Router({
    		"#two(?:[?/](.*))?": {handler: "localpage", events: "bc,c,i,bs,s,bh,h"},
    		"#index": { handler: function(type){
    			console.log("Index has been "+(type=="pagehide"?"hidden":"shown"));
    		}, events: "h,s" }
    	},{
    		localpage: function(type,match,ui){
    			console.log("localpage2: "+type);
    		}
    	}, {
    		defaultHandler: function(type, ui, page) {
    			console.log("Default handler called due to unknown route ("
    				+ type + ", " + ui + ", " + page + ")"
    			);
    		},
    		defaultHandlerEvents: "s"
    	});

    var compiledTemplate = _.template($("#template-view").html(), {element:{name:'Concert', url:"#two"}});
    $('#footer').empty().append(compiledTemplate)
</script>

</body>
</html>